var COMPILED=!0,goog=goog||{};goog.global=this;goog.exportPath_=function(a,b,c){a=a.split(".");c=c||goog.global;a[0]in c||!c.execScript||c.execScript("var "+a[0]);for(var d;a.length&&(d=a.shift());)a.length||void 0===b?c=c[d]?c[d]:c[d]={}:c[d]=b};goog.define=function(a,b){var c=b;COMPILED||goog.global.CLOSURE_DEFINES&&Object.prototype.hasOwnProperty.call(goog.global.CLOSURE_DEFINES,a)&&(c=goog.global.CLOSURE_DEFINES[a]);goog.exportPath_(a,c)};goog.DEBUG=!0;goog.LOCALE="en";goog.TRUSTED_SITE=!0;
goog.provide=function(a){if(!COMPILED){if(goog.isProvided_(a))throw Error('Namespace "'+a+'" already declared.');delete goog.implicitNamespaces_[a];for(var b=a;(b=b.substring(0,b.lastIndexOf(".")))&&!goog.getObjectByName(b);)goog.implicitNamespaces_[b]=!0}goog.exportPath_(a)};goog.setTestOnly=function(a){if(COMPILED&&!goog.DEBUG)throw a=a||"",Error("Importing test-only code into non-debug environment"+a?": "+a:".");};
COMPILED||(goog.isProvided_=function(a){return!goog.implicitNamespaces_[a]&&!!goog.getObjectByName(a)},goog.implicitNamespaces_={});goog.getObjectByName=function(a,b){for(var c=a.split("."),d=b||goog.global,e;e=c.shift();)if(goog.isDefAndNotNull(d[e]))d=d[e];else return null;return d};goog.globalize=function(a,b){var c=b||goog.global,d;for(d in a)c[d]=a[d]};
goog.addDependency=function(a,b,c){if(goog.DEPENDENCIES_ENABLED){var d;a=a.replace(/\\/g,"/");for(var e=goog.dependencies_,g=0;d=b[g];g++)e.nameToPath[d]=a,a in e.pathToNames||(e.pathToNames[a]={}),e.pathToNames[a][d]=!0;for(d=0;b=c[d];d++)a in e.requires||(e.requires[a]={}),e.requires[a][b]=!0}};goog.ENABLE_DEBUG_LOADER=!0;
goog.require=function(a){if(!COMPILED&&!goog.isProvided_(a)){if(goog.ENABLE_DEBUG_LOADER){var b=goog.getPathFromDeps_(a);if(b){goog.included_[b]=!0;goog.writeScripts_();return}}a="goog.require could not find: "+a;goog.global.console&&goog.global.console.error(a);throw Error(a);}};goog.basePath="";goog.nullFunction=function(){};goog.identityFunction=function(a,b){return a};goog.abstractMethod=function(){throw Error("unimplemented abstract method");};
goog.addSingletonGetter=function(a){a.getInstance=function(){if(a.instance_)return a.instance_;goog.DEBUG&&(goog.instantiatedSingletons_[goog.instantiatedSingletons_.length]=a);return a.instance_=new a}};goog.instantiatedSingletons_=[];goog.DEPENDENCIES_ENABLED=!COMPILED&&goog.ENABLE_DEBUG_LOADER;
goog.DEPENDENCIES_ENABLED&&(goog.included_={},goog.dependencies_={pathToNames:{},nameToPath:{},requires:{},visited:{},written:{}},goog.inHtmlDocument_=function(){var a=goog.global.document;return"undefined"!=typeof a&&"write"in a},goog.findBasePath_=function(){if(goog.global.CLOSURE_BASE_PATH)goog.basePath=goog.global.CLOSURE_BASE_PATH;else if(goog.inHtmlDocument_())for(var a=goog.global.document.getElementsByTagName("script"),b=a.length-1;0<=b;--b){var c=a[b].src,d=c.lastIndexOf("?"),d=-1==d?c.length:
d;if("base.js"==c.substr(d-7,7)){goog.basePath=c.substr(0,d-7);break}}},goog.importScript_=function(a){var b=goog.global.CLOSURE_IMPORT_SCRIPT||goog.writeScriptTag_;!goog.dependencies_.written[a]&&b(a)&&(goog.dependencies_.written[a]=!0)},goog.writeScriptTag_=function(a){if(goog.inHtmlDocument_()){var b=goog.global.document;if("complete"==b.readyState){if(/\bdeps.js$/.test(a))return!1;throw Error('Cannot write "'+a+'" after document load');}b.write('<script type="text/javascript" src="'+a+'">\x3c/script>');
return!0}return!1},goog.writeScripts_=function(){function a(e){if(!(e in d.written)){if(!(e in d.visited)&&(d.visited[e]=!0,e in d.requires))for(var f in d.requires[e])if(!goog.isProvided_(f))if(f in d.nameToPath)a(d.nameToPath[f]);else throw Error("Undefined nameToPath for "+f);e in c||(c[e]=!0,b.push(e))}}var b=[],c={},d=goog.dependencies_,e;for(e in goog.included_)d.written[e]||a(e);for(e=0;e<b.length;e++)if(b[e])goog.importScript_(goog.basePath+b[e]);else throw Error("Undefined script input");
},goog.getPathFromDeps_=function(a){return a in goog.dependencies_.nameToPath?goog.dependencies_.nameToPath[a]:null},goog.findBasePath_(),goog.global.CLOSURE_NO_DEPS||goog.importScript_(goog.basePath+"deps.js"));
goog.typeOf=function(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b};goog.isDef=function(a){return void 0!==a};goog.isNull=function(a){return null===a};goog.isDefAndNotNull=function(a){return null!=a};goog.isArray=function(a){return"array"==goog.typeOf(a)};goog.isArrayLike=function(a){var b=goog.typeOf(a);return"array"==b||"object"==b&&"number"==typeof a.length};goog.isDateLike=function(a){return goog.isObject(a)&&"function"==typeof a.getFullYear};goog.isString=function(a){return"string"==typeof a};
goog.isBoolean=function(a){return"boolean"==typeof a};goog.isNumber=function(a){return"number"==typeof a};goog.isFunction=function(a){return"function"==goog.typeOf(a)};goog.isObject=function(a){var b=typeof a;return"object"==b&&null!=a||"function"==b};goog.getUid=function(a){return a[goog.UID_PROPERTY_]||(a[goog.UID_PROPERTY_]=++goog.uidCounter_)};goog.removeUid=function(a){"removeAttribute"in a&&a.removeAttribute(goog.UID_PROPERTY_);try{delete a[goog.UID_PROPERTY_]}catch(b){}};
goog.UID_PROPERTY_="closure_uid_"+(1E9*Math.random()>>>0);goog.uidCounter_=0;goog.getHashCode=goog.getUid;goog.removeHashCode=goog.removeUid;goog.cloneObject=function(a){var b=goog.typeOf(a);if("object"==b||"array"==b){if(a.clone)return a.clone();var b="array"==b?[]:{},c;for(c in a)b[c]=goog.cloneObject(a[c]);return b}return a};goog.bindNative_=function(a,b,c){return a.call.apply(a.bind,arguments)};
goog.bindJs_=function(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}};goog.bind=function(a,b,c){Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?goog.bind=goog.bindNative_:goog.bind=goog.bindJs_;return goog.bind.apply(null,arguments)};
goog.partial=function(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=Array.prototype.slice.call(arguments);b.unshift.apply(b,c);return a.apply(this,b)}};goog.mixin=function(a,b){for(var c in b)a[c]=b[c]};goog.now=goog.TRUSTED_SITE&&Date.now||function(){return+new Date};
goog.globalEval=function(a){if(goog.global.execScript)goog.global.execScript(a,"JavaScript");else if(goog.global.eval)if(null==goog.evalWorksForGlobals_&&(goog.global.eval("var _et_ = 1;"),"undefined"!=typeof goog.global._et_?(delete goog.global._et_,goog.evalWorksForGlobals_=!0):goog.evalWorksForGlobals_=!1),goog.evalWorksForGlobals_)goog.global.eval(a);else{var b=goog.global.document,c=b.createElement("script");c.type="text/javascript";c.defer=!1;c.appendChild(b.createTextNode(a));b.body.appendChild(c);
b.body.removeChild(c)}else throw Error("goog.globalEval not available");};goog.evalWorksForGlobals_=null;goog.getCssName=function(a,b){var c=function(a){return goog.cssNameMapping_[a]||a},d=function(a){a=a.split("-");for(var b=[],d=0;d<a.length;d++)b.push(c(a[d]));return b.join("-")},d=goog.cssNameMapping_?"BY_WHOLE"==goog.cssNameMappingStyle_?c:d:function(a){return a};return b?a+"-"+d(b):d(a)};goog.setCssNameMapping=function(a,b){goog.cssNameMapping_=a;goog.cssNameMappingStyle_=b};
!COMPILED&&goog.global.CLOSURE_CSS_NAME_MAPPING&&(goog.cssNameMapping_=goog.global.CLOSURE_CSS_NAME_MAPPING);goog.getMsg=function(a,b){var c=b||{},d;for(d in c){var e=(""+c[d]).replace(/\$/g,"$$$$");a=a.replace(RegExp("\\{\\$"+d+"\\}","gi"),e)}return a};goog.getMsgWithFallback=function(a,b){return a};goog.exportSymbol=function(a,b,c){goog.exportPath_(a,b,c)};goog.exportProperty=function(a,b,c){a[b]=c};
goog.inherits=function(a,b){function c(){}c.prototype=b.prototype;a.superClass_=b.prototype;a.prototype=new c;a.prototype.constructor=a};
goog.base=function(a,b,c){var d=arguments.callee.caller;if(goog.DEBUG&&!d)throw Error("arguments.caller not defined.  goog.base() expects not to be running in strict mode. See http://www.ecma-international.org/ecma-262/5.1/#sec-C");if(d.superClass_)return d.superClass_.constructor.apply(a,Array.prototype.slice.call(arguments,1));for(var e=Array.prototype.slice.call(arguments,2),g=!1,f=a.constructor;f;f=f.superClass_&&f.superClass_.constructor)if(f.prototype[b]===d)g=!0;else if(g)return f.prototype[b].apply(a,
e);if(a[b]===d)return a.constructor.prototype[b].apply(a,e);throw Error("goog.base called from a method of one name to a method of a different name");};goog.scope=function(a){a.call(goog.global)};(function(){var a=angular.module("gn_search_manager_service",[]),b=function(a,b,e){var g=function(a){var b={},c=-1;a[0]&&a[0]["@count"]&&(a.summary=a[0],c=a[0]["@count"]);for(var d in a.summary)"@count"!=d?(b[d]=a.summary[d],b[d].name=d):c=a.summary[d];if(a.metadata)for(d=0;d<a.metadata.length||!$.isArray(a.metadata)&&1>d;d++){var f=$.isArray(a.metadata)?a.metadata[d]:a.metadata;"string"===typeof f.image&&(f.image=[f.image]);"string"===typeof f.link&&(f.link=[f.link]);f["geonet:info"].selected="true"==
f["geonet:info"].selected}d=[];a.metadata&&a.metadata.length?d=a.metadata:a.metadata&&(d=[a.metadata]);return{facet:b,count:c,metadata:d}},f=function(b,d){var f=a.defer();e.get(b).success(function(a,b){f.resolve(g(a))}).error(function(a,b){f.reject(d)});return f.promise};return{search:f,register:function(a,b){return function(){var c=b[a.pager],d="";b[a.filter]&&$.each(b[a.filter],function(a,b){d+="&"+a+"="+b});f("q@json?fast=index"+d+"&from="+(c.currentPage*c.hitsPerPage+1)+"&to="+(c.currentPage+
1)*c.hitsPerPage,a.error).then(function(d){b[a.records]=d;c.count=parseInt(d.count);c.pages=Math.round(d.count/c.hitsPerPage,0);a.success&&a.success(d)})}}}};b.$inject=["$q","$rootScope","$http"];a.factory("gnSearchManagerService",b)})();(function(){angular.module("gn_search_manager",["gn_search_manager_service"])})();(function(){angular.module("gn_cat_controller",["gn_search_manager"]).controller("GnCatController",["$scope","$http","$q","$rootScope","$translate","gnSearchManagerService",function(a,b,c,d,e,g){a.version="0.0.1";a.lang=location.href.split("/")[5];a.langs={fre:"fr",eng:"en",spa:"sp"};a.url="";a.base="../../catalog/";a.proxyUrl="../../proxy?url=";a.logoPath="../../images/harvesting/";a.pages={home:"home",admin:"admin.console",signin:"catalog.signin"};a.selectedRecordsCount=0;a.profiles=["RegisteredUser",
"Editor","Reviewer","UserAdmin","Administrator"];a.info={};a.user={};a.authenticated=!1;a.initialized=!1;a.searchInfo={};a.status=null;var f={title:"",link:"",msg:"",error:"",type:"info",timeout:-1};a.loadCatalogInfo=function(){c.when("start").then(function(c){url=a.url+"info@json?type=site&type=auth";return b.get(url).success(function(b,c){a.info=b;a.info.site.lastUpdate=new Date;a.initialized=!0}).error(function(a,b,c,f){d.$broadcast("StatusUpdated",{title:e("somethingWrong"),msg:e("msgNoCatalogInfo"),
type:"danger"})})}).then(function(c){url=a.url+"info@json?type=me";return b.get(url).success(function(b,c){a.user=b.me;a.authenticated="false"!==b.me["@authenticated"]}).error(function(a,b,c,f){d.$broadcast("StatusUpdated",{msg:e("msgNoUserInfo")})})}).then(function(b){url="qi@json?summaryOnly=true";return g.search(url).then(function(b){a.searchInfo=b})})};a.$on("loadCatalogInfo",function(b,c){a.loadCatalogInfo()});a.clearStatusMessage=function(){a.status=null;$(".gn-info").hide()};a.$on("StatusUpdated",
function(b,c){a.status={};$.extend(a.status,f,c);$(".gn-info").show();0<a.status.timeout&&setTimeout(function(){a.clearStatusMessage()},1E3*a.status.timeout)});a.selectMetadata=function(a){console.log("select "+a)};a.selectAllMetadata=function(){console.log("select all ")};a.loadCatalogInfo()}])})();(function(){var a=angular.module("gn_utility_service",[]);a.factory("gnUtilityService",function(){var a=function(c){angular.forEach(c,function(d,e){if("string"==typeof d)if("true"==d||"false"==d)c[e]="true"==d;else{if("on"==d||"off"==d)c[e]="on"==d}else a(d)})};return{scrollTo:function(a,b,e,g){$(document.body).animate({scrollTop:b?$(a).offset().top:$(a).position().top},e,g)},isInView:function(a){var b=$(window).scrollTop(),e=b+window.innerHeight,g=parseInt($(a).offset().top);a=parseInt(g+$(a).height());
return a<e&&a>b||g>b&&g<e||g<b&&a>e},serialize:function(a){a=$(a);var b=[];$(":checkbox:not(:checked)",a).each(function(){b.push(encodeURIComponent(this.name)+"=false")});return a.serialize()+(b.length?"&"+b.join("&").replace(/%20/g,"+"):"")},parseBoolean:a,toCsv:function(a,b,e){var g,f,h=[],k,l,n,m,p="",q,r;if("undefined"===typeof b||null===b)b='"';if("undefined"===typeof e||null===e)e=",";g=0;for(f=a.length;g<f;g+=1){n=a[g];m="";if(0===g){for(k in n)n.hasOwnProperty(k)&&(h.push(k),m+=[b,k,b,e].join(""));
m=m.substring(0,m.length-1);p+=m}p+="\n";m="";q=0;for(r=h.length;q<r;q+=1){k=h[q];l=n[k];0<q&&(m+=",");var s='"',t=typeof l,u=void 0;if("undefined"===typeof s||null===s)s='"';u="undefined"===t||null===t?"":"string"===t?s+l+s:String(l);m+=u}p+=m}return p},getUrlParameter:function(a){var b=null;angular.forEach(window.location.search.replace("?","").split("&"),function(e){0===e.indexOf(a)&&(b=e.split("=")[1])});return b}}});a.filter("gnFromNow",function(){return function(a){return moment(new Date(a)).fromNow()}})})();(function(){angular.module("gn_utility",["gn_utility_service"])})();(function(){angular.module("gn_pagination_directive",[]).directive("gnPagination",["gnMetadataManagerService",function(a){return{restrict:"A",replace:!0,transclude:!0,scope:{config:"=gnPagination"},templateUrl:"../../catalog/components/pagination/partials/pagination.html",link:function(a,c,d){a.previous=function(){0<a.config.currentPage&&(a.config.currentPage-=1)};a.next=function(){a.config.currentPage<a.config.pages&&(a.config.currentPage+=1)}}}}])})();(function(){angular.module("gn_pagination",["gn_pagination_directive"])})();(function(){var a=angular.module("gn_metadata_manager_service",[]),b=function(a,b,e){var g=function(b,d,k){var l=a.defer();e.get("metadata.select@json?"+(b?"id="+b:"")+(d?"":"&selected="+k)).success(function(a,b){l.resolve(a)}).error(function(a,b){l.reject(error)});return l.promise};return{select:function(a,b){return g(a,b,"add")},unselect:function(a){return g(a,!1,"remove")},selectAll:function(){return g(null,!1,"add-all")},selectNone:function(){return g(null,!1,"remove-all")},view:function(a){window.open("../../?uuid="+
a["geonet:info"].uuid,"gn-view")},edit:function(a){location.href="catalog.edit?#/metadata/"+a["geonet:info"].id}}};b.$inject=["$q","$rootScope","$http"];a.factory("gnMetadataManagerService",b)})();(function(){angular.module("gn_metadata_manager",["gn_metadata_manager_service"])})();(function(){angular.module("gn_language_switcher_directive",["pascalprecht.translate"]).directive("gnLanguageSwitcher",["$translate",function(a){return{restrict:"A",replace:!1,transclude:!0,scope:{langs:"=langs",lang:"=gnLanguageSwitcher"},template:'<select class="form-control" ng-model="lang" ng-options="key as (key | translate) for (key, value) in langs"></select>',link:function(a,c,d){a.$watch("lang",function(c){var d=location.href.split("/");c!=d[5]&&(d[5]=c,location.href=d.join("/"),moment&&
moment.lang(a.langs[c]))})}}}])})();(function(){angular.module("gn_language_switcher",["gn_language_switcher_directive"])})();(function(){angular.module("gn_search_results_directive",[]).directive("gnSearchResults",["gnMetadataManagerService",function(a){return{restrict:"A",replace:!0,transclude:!0,scope:{allowSelection:"@allowSelection",authenticated:"=authenticated",selectedRecordsCount:"=selectedRecordsCount",searchResults:"=gnSearchResults"},templateUrl:"../../catalog/components/searchresults/partials/searchresults.html",link:function(b,c,d){b.select=function(c,d){var f=c["geonet:info"].uuid;($("#gn-record-"+f).hasClass("active")?
a.unselect:a.select)(f).then(function(a){b.selectedRecordsCount=a[0];c["geonet:info"].selected=!0!==c["geonet:info"].selected})};b.selectAll=function(c){(c?a.selectAll:a.selectNone)().then(function(a){b.selectedRecordsCount=a[0];angular.forEach(b.searchResults.metadata,function(a){a["geonet:info"].selected=c?!0:!1})})};b.view=function(b,c){a.view(b)};b.edit=function(b,c){a.edit(b)}}}}])})();(function(){angular.module("gn_search_results",["gn_search_results_directive"])})();(function(){angular.module("gn_search_controller",[]).controller("GnSearchController",["$scope","$routeParams","$http","$rootScope","$translate","$compile","gnMetadataManagerService","gnSearchManagerService","gnUtilityService",function(a,b,c,d,e,g,f,h,k){a.searchRecordsFilter="";a.searchRecords=null;a.searchRecordsPagination={pages:-1,currentPage:0,hitsPerPage:20};searchFn=h.register({records:"searchRecords",filter:"searchRecordsFilter",pager:"searchRecordsPagination"},a);a.searchRecordsSearchFor=
function(b){a.searchRecordsFilter={any:b?b.target.value:""};a.searchRecordsPagination.currentPage=0;searchFn()};a.$watch("searchRecordsPagination.currentPage",function(){searchFn()})}])})();(function(){var a=angular.module("gn","ngRoute pascalprecht.translate gn_language_switcher gn_utility gn_search_manager gn_metadata_manager gn_search_results gn_pagination gn_cat_controller gn_search_controller".split(" "));a.constant("$LOCALES",["core"]);a.factory("localeLoader",["$http","$q",function(a,c){return function(d){var e=[];angular.forEach(d.locales,function(g,f){var h=d.prefix+d.key+"-"+g+d.suffix,k=c.defer();e.push(k.promise);a({method:"GET",url:h}).success(function(a,b,c,d){k.resolve(a)}).error(function(a,
b,c,f){k.reject(d.key)})});return c.all(e)}}]);a.config(["$translateProvider","$LOCALES",function(a,c){a.useLoader("localeLoader",{locales:c,prefix:"../../catalog/locales/",suffix:".json"});var d=location.href.split("/")[5].substring(0,2)||"en";a.preferredLanguage(d);moment.lang(d)}])})();(function(){angular.module("gn_dbtranslation_directive",[]).directive("gnDbTranslation",["$http","$translate","$rootScope",function(a,b,c){return{restrict:"A",replace:!0,transclude:!0,scope:{type:"@type",element:"=gnDbTranslation"},templateUrl:"../../catalog/components/admin/dbtranslation/partials/dbtranslation.html",link:function(d,e,g){d.saveTranslation=function(f){var e="<request><"+d.type+' id="{{id}}"><label><{{key}}>{{value}}</{{key}}></label></'+d.type+"></request>",e=e.replace("{{id}}",d.element.id||
d.element["@id"]).replace(/{{key}}/g,f.key).replace("{{value}}",f.value);a.post("admin."+d.type+".update.labels",e,{headers:{"Content-type":"application/xml"}}).success(function(a){}).error(function(a){c.$broadcast("StatusUpdated",{title:b(d.type+"TranslationUpdateError"),error:a,timeout:0,type:"danger"})})}}}}])})();(function(){angular.module("gn_dbtranslation",["gn_dbtranslation_directive"])})();(function(){angular.module("gn_usergroup_controller",["gn_dbtranslation"]).controller("GnUserGroupController",["$scope","$routeParams","$http","$rootScope","$translate","$compile","$location","gnSearchManagerService",function(a,b,c,d,e,g,f,h){function k(){c.get("admin.group.list@json").success(function(b){a.groups="null"!==b?b:null}).error(function(a){}).then(function(){b.userOrGroup&&angular.forEach(a.groups,function(c){c.name===b.userOrGroup&&a.selectGroup(c)})})}function l(){c.get("admin.user.list@json").success(function(b){a.users=
b}).error(function(a){}).then(function(){b.userOrGroup&&angular.forEach(a.users,function(c){c.username===b.userOrGroup&&a.selectUser(c)})})}a.pageMenu={folder:"usergroup/",defaultTab:"groups",tabs:[{type:"groups",label:"manageGroups",icon:"fa-group",href:"#/organization/groups"},{type:"users",label:"manageUsers",icon:"fa-user",href:"#/organization/users"}]};a.groupRecordsPagination={pages:-1,currentPage:0,hitsPerPage:10};a.groups=null;a.groupSelected={id:b.userOrGroup};a.groupRecords=null;a.groupRecordsFilter=
null;a.groupUpdated=!1;a.groupSearch={};a.groupRecordsSearch=h.register({records:"groupRecords",filter:"groupRecordsFilter",pager:"groupRecordsPagination"},a);a.$watch("groupRecordsPagination.currentPage",function(){a.groupRecordsSearch()});a.users=null;a.userSelected={};a.userGroups={};a.userOperation="editinfo";a.userIsAdmin=!1;a.userUpdated=!1;a.passwordCheck="";a.userRecordsPagination={pages:-1,currentPage:0,hitsPerPage:10};a.userRecords=null;a.userRecordsFilter=null;a.userRecordsSearch=h.register({records:"userRecords",
filter:"userRecordsFilter",pager:"userRecordsPagination"},a);a.$watch("userRecordsPagination.currentPage",function(){a.userRecordsSearch()});a.addUser=function(){a.unselectUser();a.userOperation="newuser";a.userSelected={id:"",username:"",password:"",name:"",surname:"",profile:"RegisteredUser",address:"",city:"",state:"",zip:"",country:"",email:"",organisation:""}};a.unselectUser=function(){a.userSelected=null;a.userGroups=null;a.userUpdated=!1;a.userRecords=null;a.userOperation="editinfo"};a.selectUser=
function(b){c.get("admin.usergroups.list@json?id="+b.id).success(function(c){a.userGroups=c;a.userSelected=b;a.userIsAdmin="Administrator"===b.profile}).error(function(a){});a.userRecordsFilter={template:"y or n",_owner:b.id,sortBy:"title"};a.userRecordsSearch();a.userUpdated=!1};a.isUserGroup=function(b,c){if(a.userGroups)for(var d=0;d<a.userGroups.length;d++)if(a.userGroups[d].id==b&&a.userGroups[d].profile==c)return!0;return!1};a.setUserProfile=function(b){a.userUpdated=!0;if(b){for(b=0;b<a.profiles.length;b++)"Administrator"!==
a.profiles[b]&&($("#groups_"+a.profiles[b])[0].selectedIndex=-1);a.userSelected.profile=a.userIsAdmin?"Administrator":a.profiles[0]}else{var c="RegisteredUser";for(b=0;b<a.profiles.length;b++)if("Administrator"!==a.profiles[b]){var d=$("#groups_"+a.profiles[b])[0];-1<d.selectedIndex&&""!=d.options[d.selectedIndex].value&&(c=a.profiles[b])}a.userSelected.profile=c;b=$("#groups_Editor")[0];c=$("#groups_Reviewer")[0];if(-1<c.selectedIndex)for(d=0;d<c.options.length;d++)c.options[d].selected&&(b.options[d].selected=
!0)}};a.updatingUser=function(){a.userUpdated=!0};a.saveUser=function(b){c.get("admin.user.update?"+$(b).serialize()).success(function(b){a.unselectUser();l();d.$broadcast("StatusUpdated",{msg:e("userUpdated"),timeout:2,type:"success"})}).error(function(a){d.$broadcast("StatusUpdated",{title:e("userUpdateError"),error:a,timeout:0,type:"danger"})})};a.deleteUser=function(b){c.get("admin.user.remove?id="+a.userSelected.id).success(function(b){a.unselectUser();l()}).error(function(a){d.$broadcast("StatusUpdated",
{title:e("userDeleteError"),error:a,timeout:0,type:"danger"})})};a.userHasRecords=function(){return a.userRecords&&a.userRecords.metadata&&0<a.userRecords.metadata.length};a.addGroup=function(){a.unselectGroup();a.groupSelected={id:"",name:"",description:"",email:""}};a.saveGroup=function(b){c.get("admin.group.update?"+$(b).serialize()).success(function(b){a.unselectGroup();k();d.$broadcast("StatusUpdated",{msg:e("groupUpdated"),timeout:2,type:"success"})}).error(function(a){d.$broadcast("StatusUpdated",
{title:e("groupUpdateError"),error:a,timeout:0,type:"danger"})})};a.deleteGroup=function(b){c.get("admin.group.remove?id="+a.groupSelected.id).success(function(b){a.unselectGroup();k()}).error(function(a){d.$broadcast("StatusUpdated",{title:e("groupDeleteError"),error:a,timeout:0,type:"danger"})})};a.groupHasRecords=function(){return a.groupRecords&&a.groupRecords.metadata&&0<a.groupRecords.metadata.length};a.unselectGroup=function(){a.groupSelected=null;a.groupUpdated=!1;a.groupRecords=null};a.selectGroup=
function(b){a.groupSelected=b;a.groupRecordsFilter={template:"y or n",group:b.id,sortBy:"title"};a.groupRecordsSearch();a.groupUpdated=!1};a.updatingGroup=function(){a.groupUpdated=!0};k();l()}])})();(function(){angular.module("gn_standards_controller",[]).controller("GnStandardsController",["$scope","$routeParams","$http","$rootScope","$translate","$compile","gnMetadataManagerService","gnSearchManagerService","gnUtilityService",function(a,b,c,d,e,g,f,h,k){function l(){c.get("admin.schema.list@json").success(function(b){for(var c=0;c<b.length;c++)a.schemas.push({id:b[c]["#text"].trim(),props:b[c]});a.schemas.sort()})}a.pageMenu={folder:"standards/",defaultTab:"standards",tabs:[]};a.schemas=[];
a.addStandard=function(a,b){c.get("admin.schema."+b+"?"+$(a).serialize()).success(function(a){l();d.$broadcast("StatusUpdated",{msg:e("standardAdded"),timeout:2,type:"success"})}).error(function(a){d.$broadcast("StatusUpdated",{title:e("standardAddError"),error:a,timeout:0,type:"danger"})})};a.removeStandard=function(a){c.get("admin.schema.remove@json?schema="+a).success(function(a){"error"===a["@status"]?d.$broadcast("StatusUpdated",{title:e("standardsDeleteError"),msg:a["@message"],timeout:0,type:"danger"}):
l()}).error(function(a){d.$broadcast("StatusUpdated",{title:e("standardsDeleteError"),error:a,timeout:0,type:"danger"})})};l()}])})();(function(){angular.module("gn_categories_controller",[]).controller("GnCategoriesController",["$scope","$routeParams","$http","$rootScope","$translate",function(a,b,c,d,e){function g(){c.get("info@json?type=categories").success(function(b){a.categories=b.metadatacategory}).error(function(a){})}a.categories=null;a.categorySelected={id:b.categoryId};a.categoryUpdated=!1;a.selectCategory=function(b){a.cateroryUpdated=!1;a.categorySelected=b};a.deleteCategory=function(b){c.get("admin.category.remove?id="+
b).success(function(b){a.unselectCategory();g()}).error(function(a){d.$broadcast("StatusUpdated",{title:e("categoryDeleteError"),error:a,timeout:0,type:"danger"})})};a.saveCategory=function(b){c.get("admin.category.update?"+$(b).serialize()).success(function(b){a.unselectCategory();g();d.$broadcast("StatusUpdated",{msg:e("categoryUpdated"),timeout:2,type:"success"})}).error(function(a){d.$broadcast("StatusUpdated",{title:e("categoryUpdateError"),error:a,timeout:0,type:"danger"})})};a.addCategory=
function(){a.unselectCategory();a.categorySelected={"@id":"",name:""}};a.unselectCategory=function(){a.categorySelected={}};a.updatingCategory=function(){a.categoryUpdated=!0};g()}])})();(function(){angular.module("gn_thesaurus_type_directive",[]).directive("gnThesaurusType",[function(){return{restrict:"A",replace:!0,transclude:!0,scope:{typeList:"=gnThesaurusType",model:"=gnModel",disabled:"=gnDisabled"},templateUrl:"../../catalog/components/thesaurus-type/partials/thesaurus-type.html",link:function(a,b,c){a.types=a.typeList||["theme","discipline","place","stratum","temporal"]}}}])})();(function(){angular.module("gn_thesaurus_type",["gn_thesaurus_type_directive"])})();(function(){angular.module("gn_thesaurus_controller",["gn_thesaurus_type","blueimp.fileupload"]).controller("GnThesaurusController",["$scope","$http","$rootScope","$translate",function(a,b,c,d){function e(){b.get("thesaurus@json").success(function(b){a.thesaurus=b[0]})}var g=["broader","narrower","related"];a.thesaurusClass=["theme","discipline","place","stratum","temporal"];a.thesaurus={};a.thesaurusSelected=null;a.thesaurusSelectedActivated=!1;a.thesaurusSuggestedNs="";a.thesaurusUrl="";a.keywords=
{};a.keywordSelected=null;a.keywordSelectedRelation={};a.keywordSuggestedUri="";a.keywordFilter="";a.maxNumberOfKeywords=50;a.importAs=null;var f=!1,h=!1,k=null;a.selectThesaurus=function(b){f=!1;a.thesaurusSelected=b;a.thesaurusSelectedActivated="y"==b.activated;searchThesaurusKeyword()};searchThesaurusKeyword=function(){a.thesaurusSelected&&b.get("keywords@json?pNewSearch=true&pTypeSearch=1&pThesauri="+a.thesaurusSelected.key+"&pMode=searchBox&maxResults="+(a.maxNumberOfKeywords||50)+"&pKeyword="+
(a.keywordFilter||"*")).success(function(b){a.keywords=b[0]})};a.addThesaurus=function(b){f=!0;a.importAs=b;a.thesaurusSelected={title:"",filename:"",defaultNamespace:"http://www.mysite.org/thesaurus",dname:"theme",type:"local"};$("#thesaurusModal").modal();$("#thesaurusModal").on("shown.bs.modal",function(){$("new"===a.importAs?"#gn-thesaurus-title":"file"===a.importAs?"#gn-thesaurus-file":"#gn-thesaurus-url").focus()})};a.computeThesaurusNs=function(){a.thesaurusSuggestedNs=location.origin+"/thesaurus/"+
a.thesaurusSelected.dname+"/"+a.thesaurusSelected.filename.replace(/[^\d\w]/gi,"")};a.useSuggestedNs=function(){a.thesaurusSelected.defaultNamespace=a.thesaurusSuggestedNs};a.createThesaurus=function(){b.post("thesaurus.update","<request><tname>"+a.thesaurusSelected.title+"</tname><fname>"+a.thesaurusSelected.filename+"</fname><tns>"+a.thesaurusSelected.defaultNamespace+"</tns><dname>"+a.thesaurusSelected.dname+"</dname><type>local</type></request>",{headers:{"Content-type":"application/xml"}}).success(function(b){a.thesaurusSelected=
null;$("#thesaurusModal").modal("hide");e()}).error(function(a){c.$broadcast("StatusUpdated",{title:d("thesaurusCreationError"),error:a,timeout:0,type:"danger"})})};uploadThesaurusDone=function(b){a.clear(a.queue);a.thesaurusUrl="";$("#thesaurusModal").modal("hide");e()};uploadThesaurusError=function(a){c.$broadcast("StatusUpdated",{title:d("thesaurusUploadError"),error:a,timeout:0,type:"danger"})};a.thesaurusUploadOptions={autoUpload:!1,done:uploadThesaurusDone,fail:uploadThesaurusError};a.importThesaurus=
function(c){$(c)[0].enctype="file"===a.importAs?"multipart/form-data":"";"file"===a.importAs?a.submit():b.get("thesaurus.upload?"+$(c).serialize()).success(uploadThesaurusDone).error(uploadThesaurusError)};a.deleteThesaurus=function(){b.get("thesaurus.remove?ref="+a.thesaurusSelected.key).success(function(b){a.thesaurusSelected=null;e()}).error(function(a){c.$broadcast("StatusUpdated",{title:d("thesaurusDeleteError"),error:a,timeout:0,type:"danger"})})};a.enableThesaurus=function(){b.get("thesaurus.activate@json?ref="+
a.thesaurusSelected.key+"&activated="+(a.thesaurusSelectedActivated?"y":"n")).success(function(a){})};a.isNew=function(){return f};a.isNewKeyword=function(){return h};searchRelation=function(c){a.keywordSelectedRelation={};$.each(g,function(d,f){b.get("thesaurus.keyword.links@json?request="+f+"&thesaurus="+a.thesaurusSelected.key+"&id="+encodeURIComponent(c.uri)).success(function(b){a.keywordSelectedRelation[f]=b.descKeys}).error()})};a.editKeyword=function(b){a.keywordSelected=b;k=b.uri;h=!1;$("#keywordModal").modal();
searchRelation(b)};a.addKeyword=function(b){h=!0;a.keywordSuggestedUri="";a.keywordSelected={uri:a.thesaurusSelected.defaultNamespace+"#",value:{"@language":a.lang,"#text":""},definition:{"@language":a.lang},defaultLang:a.lang};a.isPlaceType()&&(a.keywordSelected.geo={west:"",south:"",east:"",north:""});$("#keywordModal").modal()};buildKeyword=function(){var b=a.isPlaceType()?"<west>"+a.keywordSelected.geo.west+"</west><south>"+a.keywordSelected.geo.south+"</south><east>"+a.keywordSelected.geo.east+
"</east><north>"+a.keywordSelected.geo.north+"</north>":"";return"<request><newid>"+a.keywordSelected.uri+"</newid><refType>"+a.thesaurusSelected.dname+"</refType><definition>"+a.keywordSelected.definition["#text"]+"</definition><namespace>"+a.thesaurusSelected.defaultNamespace+"</namespace><ref>"+a.thesaurusSelected.key+"</ref><oldid>"+k+"</oldid><lang>"+a.lang+"</lang><prefLab>"+a.keywordSelected.value["#text"]+"</prefLab>"+b+"</request>"};a.createKeyword=function(){b.post("thesaurus.keyword.add",
buildKeyword(),{headers:{"Content-type":"application/xml"}}).success(function(b){a.keywordSelected=null;$("#keywordModal").modal("hide");searchThesaurusKeyword();h=!1}).error(function(a){c.$broadcast("StatusUpdated",{title:d("keywordCreationError"),error:a,timeout:0,type:"danger"})})};a.updateKeyword=function(){b.post("thesaurus.keyword.update",buildKeyword(),{headers:{"Content-type":"application/xml"}}).success(function(b){a.keywordSelected=null;$("#keywordModal").modal("hide");searchThesaurusKeyword();
k=null}).error(function(a){c.$broadcast("StatusUpdated",{title:d("keywordUpdateError"),error:a,timeout:0,type:"danger"})})};a.deleteKeyword=function(f){a.keywordSelected=f;b.get("thesaurus.keyword.remove?pThesaurus="+f.thesaurus.key+"&id="+encodeURIComponent(f.uri)).success(function(a){searchThesaurusKeyword()}).error(function(a){c.$broadcast("StatusUpdated",{title:d("keywordDeleteError"),error:a,timeout:0,type:"danger"})})};a.computeKeywordId=function(){a.keywordSuggestedUri=a.thesaurusSelected.defaultNamespace+
"#"+a.keywordSelected.value["#text"].replace(/[^\d\w]/gi,"")};a.useSuggestedUri=function(){a.keywordSelected.uri=a.keywordSuggestedUri};a.isPlaceType=function(){return a.thesaurusSelected?a.thesaurusSelected.key&&-1!==a.thesaurusSelected.key.indexOf(".place."):!1};a.isExternal=function(){return a.thesaurusSelected?"external"===a.thesaurusSelected.type:!1};a.$watch("maxNumberOfKeywords",function(){searchThesaurusKeyword()});a.$watch("keywordFilter",function(){searchThesaurusKeyword()});e()}])})();(function(){angular.module("gn_classification_controller",["gn_thesaurus_controller","gn_categories_controller"]).controller("GnClassificationController",["$scope","$http",function(a,b){a.pageMenu={folder:"classification/",defaultTab:"thesaurus",tabs:[{type:"thesaurus",label:"manageThesaurus",icon:"fa-archive",href:"#/classification/thesaurus"},{type:"directory",label:"manageDirectory",icon:"fa-list-ul",href:"subtemplate.admin"},{type:"categories",label:"manageCategory",icon:"fa-tags",href:"#/classification/categories"}]}}])})();(function(){angular.module("gn_admintools_controller",[]).controller("GnAdminToolsController",["$scope","$http","$rootScope","$translate","$compile","$q","$timeout","gnMetadataManagerService","gnSearchManagerService","gnUtilityService",function(a,b,c,d,e,g,f,h,k,l){function n(){return b.get("md.processing.batch.report@json").success(function(b,c){"null"!=b&&(a.processReport=b,a.numberOfRecordsProcessed=b["@processedRecords"]);a.processReport&&"true"==a.processReport["@running"]&&f(n,p)})}function m(){return b.get("info@json?type=index").success(function(c,
d){a.isIndexing="true"==c.index;a.isIndexing&&f(m,q);b.get("qi@json?template=y or n or s&summaryOnly=true").success(function(b,c){a.numberOfIndexedRecords=b[0]["@count"]})})}a.pageMenu={folder:"tools/",defaultTab:"index",tabs:[{type:"index",label:"indexAdmin",icon:"fa-search",href:"#/tools/index"},{type:"batch",label:"batchProcess",icon:"fa-medkit",href:"#/tools/batch"},{type:"transfert-privs",label:"transfertPrivs",href:"transfer.ownership"}]};a.processing=!1;a.recordsToProcessFilter="";a.processReport=
null;a.processReportWarning=!1;a.recordsToProcess=null;a.numberOfRecordsProcessed=null;a.recordsToProcessPagination={pages:-1,currentPage:0,hitsPerPage:10};a.selectedProcess=null;a.batchProcesses=null;a.batchSearchTemplateY=!0;a.batchSearchTemplateN=!0;a.batchSearchTemplateS=!1;a.batchSearchGroups={};a.batchSearchUsers={};a.batchSearchCategories={};var p=1E3;a.runProcess=function(e){a.processing=!0;a.processReport=null;b.get("md.processing.batch@json?"+$(e).serialize()).success(function(b){a.processReport=
b;a.processReportWarning=0!=b.notFound||0!=b.notOwner||0!=b.notProcessFound;c.$broadcast("StatusUpdated",{msg:d("processFinished"),timeout:2,type:"success"});a.processing=!1;n()}).error(function(b){c.$broadcast("StatusUpdated",{title:d("processError"),error:b,timeout:0,type:"danger"});a.processing=!1});l.scrollTo("#gn-batch-process-report");f(n,p)};(function(){b.get(a.base+"config/batch-process-cfg.json").success(function(b){a.batchProcesses=b.config})})();n();(function(){b.get("admin.group.list@json").success(function(b){a.batchSearchGroups=
b}).error(function(a){})})();(function(){b.get("admin.user.list@json").success(function(b){a.batchSearchUsers=b}).error(function(a){})})();(function(){b.get("info@json?type=categories").success(function(b){a.batchSearchCategories=b.categories}).error(function(a){})})();a.recordsToProcessSearchFor=function(b){a.recordsToProcessFilter=b?b.target.value:"";a.recordsToProcessPagination.currentPage=0;a.recordsToProcessSearch()};a.recordsToProcessSearch=function(){var b=a.recordsToProcessPagination,b=[{fast:"index"},
{from:b.currentPage*b.hitsPerPage+1},{to:(b.currentPage+1)*b.hitsPerPage},{any:a.recordsToProcessFilter}];templateValues=[];angular.forEach({"#gn-batchSearchTemplateY":"y","#gn-batchSearchTemplateN":"n","#gn-batchSearchTemplateS":"s"},function(a,b){$(b)[0]&&$(b)[0].checked&&templateValues.push(a)});b.push({template:templateValues.join(" or ")});if($("#gn-batchSearchGroupOwner")[0]){var c=$("#gn-batchSearchGroupOwner")[0].options[$("#gn-batchSearchGroupOwner")[0].selectedIndex].value;""!==c&&b.push({group:c})}$("#gn-batchSearchOwner")[0]&&
(c=$("#gn-batchSearchOwner")[0].options[$("#gn-batchSearchOwner")[0].selectedIndex].value,""!==c&&b.push({_owner:c}));$("#gn-batchSearchCategory")[0]&&(c=$("#gn-batchSearchCategory")[0].options[$("#gn-batchSearchCategory")[0].selectedIndex].value,""!==c&&b.push({category:c}));var d="";angular.forEach(b,function(a){angular.forEach(a,function(a,b){d+=b+"="+a+"&"})});k.search("q@json?"+d).then(function(b){a.recordsToProcess=b;a.recordsToProcessPagination.pages=Math.round(b.count/a.recordsToProcessPagination.hitsPerPage,
0)},function(a){})};angular.forEach(["recordsToProcessPagination.currentPage"],function(b){a.$watch(b,function(){a.recordsToProcessSearch()})});h.selectNone().then(function(){a.recordsToProcessSearch()});a.isIndexing=!1;a.numberOfIndexedRecords=null;var q=1E3;m();a.rebuildIndex=function(){b.get("admin.index.rebuild?reset=yes").success(function(a){m()}).error(function(a){c.$broadcast("StatusUpdated",{title:d("rebuildIndexError"),error:a,timeout:0,type:"danger"})})};a.optimizeIndex=function(){b.get("admin.index.optimize").success(function(a){c.$broadcast("StatusUpdated",
{msg:d("indexOptimizationInProgress"),timeout:2,type:"success"})}).error(function(a){c.$broadcast("StatusUpdated",{title:d("rebuildIndexError"),error:a,timeout:0,type:"danger"})})};a.reloadLuceneConfig=function(){b.get("admin.index.config.reload").success(function(a){c.$broadcast("StatusUpdated",{msg:d("luceneConfigReloaded"),timeout:2,type:"success"})}).error(function(a){c.$broadcast("StatusUpdated",{title:d("rebuildIndexError"),error:a,timeout:0,type:"danger"})})};a.clearXLinkCache=function(){b.get("admin.index.rebuildxlinks").success(function(a){c.$broadcast("StatusUpdated",
{msg:d("xlinkCacheCleared"),timeout:2,type:"success"})}).error(function(a){c.$broadcast("StatusUpdated",{title:d("rebuildIndexError"),error:a,timeout:0,type:"danger"})})}}])})();(function(){angular.module("gn_adminmetadata_controller",[]).controller("GnAdminMetadataController",["$scope","$routeParams","$http","$rootScope","$translate","$compile","gnMetadataManagerService","gnSearchManagerService","gnUtilityService",function(a,b,c,d,e,g,f,h,k){function l(){c.get("admin.schema.list@json").success(function(c){for(var d=0;d<c.length;d++)a.schemas.push(c[d]["#text"].trim());a.schemas.sort();"all"===b.schema?a.selectAllSchemas(!0):void 0!==b.schema&&a.selectSchema(b.schema.split(","));
"load-samples"===b.metadataAction?a.loadSamples():"load-templates"===b.metadataAction?a.loadTemplates():"load-samples-and-templates"===b.metadataAction&&(a.loadSamples(),a.loadTemplates())})}a.pageMenu={folder:"metadata/",defaultTab:"metadata-and-template",tabs:[{type:"metadata-and-template",label:"metadataAndTemplates",icon:"fa-archive",href:"#/metadata/metadata-and-template"},{type:"template-sort",label:"sortTemplate",icon:"fa-sort",href:"#/metadata/template-sort"}]};a.schemas=[];a.selectedSchemas=
[];a.loadReport=null;a.loadTplReport=null;a.tplLoadRunning=!1;a.sampleLoadRunning=!1;selectSchema=function(b){var c=a.selectedSchemas.indexOf(b);-1===c?a.selectedSchemas.push(b):a.selectedSchemas.splice(c,1)};a.selectSchema=function(b){Array.isArray(b)?$.each(b,function(a,b){selectSchema(b)}):selectSchema(b);a.loadReport=null;a.loadTplReport=null};a.isSchemaSelected=function(b){return-1!==a.selectedSchemas.indexOf(b)};a.selectAllSchemas=function(b){a.selectedSchemas=b?a.schemas:[];a.loadReport=null;
a.loadTplReport=null};a.loadTemplates=function(){a.tplLoadRunning=!0;c.get("admin.load.templates@json?schema="+a.selectedSchemas.join(",")).success(function(b){a.loadTplReport=b;a.tplLoadRunning=!1}).error(function(b){a.tplLoadRunning=!1})};a.loadSamples=function(){a.sampleLoadRunning=!0;c.get("admin.load.samples@json?file_type=mef&uuidAction=overwrite&schema="+a.selectedSchemas.join(",")).success(function(b){a.loadReport=b;a.sampleLoadRunning=!1}).error(function(b){a.sampleLoadRunning=!1})};a.templates=
null;var n=function(){c.get("admin.templates.list@json").success(function(b){a.templates=b})};a.saveOrder=function(a){c.get("admin.templates.save.order?"+$(a).serialize()).success(function(a){n()}).error(function(a){d.$broadcast("StatusUpdated",{title:e("saveTemplateOrderError"),error:a,timeout:0,type:"danger"})})};a.sortOrder=function(a){return parseInt(a.displayorder)};"template-sort"===b.tab?n():l()}])})();(function(){angular.module("gn_gauge_directive",[]).directive("gnGauge",function(){return{restrict:"A",require:"?ngModel",link:function(a,b,c){c.id||console.log("Define an ID attribute to locate the target element to put the gauge in.");a.$watch(c.ngModel,function(){var b=a.$eval(c.gnGaugeValue);if(b){var e=a.gauges,g=c.id,f={id:c.id,label:c.gnGauge,min:a.$eval(c.gnGaugeMin),max:a.$eval(c.gnGaugeMax)},h={size:f.size||120,label:f.label,min:f.min||0,max:f.max||100,minorTicks:f.ticks||5},k=h.max-h.min;
h.yellowZones=[{from:h.min+0.75*k,to:h.min+0.9*k}];h.redZones=[{from:h.min+0.9*k,to:h.max}];f=new Gauge(f.id,h);f.render();e[g]=f;a.gauges[c.id].redraw(b)}})}}})})();(function(){angular.module("gn_gauge",["gn_gauge_directive"])})();(function(){angular.module("gn_dashboard_status_controller",["gn_gauge"]).controller("GnDashboardStatusController",["$scope","$routeParams","$http",function(a,b,c){a.healthy=void 0;a.gauges=[];a.hits=20;c.get("../../criticalhealthcheck").success(function(b){a.healthy=!0;a.healthcheck=b}).error(function(b){a.healthy=!1;a.healthcheck=b});c.get("qi@json?fast=index&sortBy=changeDate&_indexingError=1&from=1&to="+a.hits).success(function(b){a.mdWithIndexingError=b.metadata instanceof Array?b.metadata:[b.metadata]}).error(function(a){})}])})();(function(){angular.module("gn_dashboard_search_stat_controller",[]).controller("GnDashboardSearchStatController",["$scope","$routeParams","$http","$translate","$sce",function(a,b,c,d,e){function g(){c.get(a.url+"statistics-search-by-date@json?dateFrom="+a.dateFrom+"&dateTo="+a.dateTo+"&graphicType="+a.graphicType+"&byType=true").success(function(b){a.dateMin=b.dateMin.substring(0,10);a.dateMax=b.dateMax.substring(0,10);if(null===a.dateFrom)a.dateFrom=a.dateMin,a.dateTo=a.dateMax;else if(b.requests){a.statistics.search.temporal=
[];for(var c=[],e=0;e<b.requests.length;e++){var g=b.requests[e];if(g.record)if($.isArray(g.record))for(var n=0;n<g.record.length;n++)c.push(g.record[n].reqdate);else c.push(g.record.reqdate),g.record=[g.record]}c.sort();for(e=0;e<b.requests.length;e++)if((g=b.requests[e].record)&&0<g.length){for(var m=[],n=0;n<c.length;n++){for(var p=!1,q=0;q<g.length;q++){var r=g[q];r.reqdate==c[n]&&(p=!0,m.push(r),q=g.length)}p||m.push({reqdate:c[n],number:0})}a.statistics.search.temporal.push({key:d(b.requests[e]["@service"]),
values:m})}0!==a.statistics.search.temporal.length&&nv.addGraph(function(){var b=nv.models.multiBarChart().x(function(a){return a.reqdate}).y(function(a){return parseInt(a.number)}).stacked(!0);b.reduceXTicks(!1).staggerLabels(!0);b.yAxis.axisLabel("Number of requests").tickFormat(d3.format(".f"));d3.select("#gn-stat-search-timeline").datum(a.statistics.search.temporal).transition().duration(500).call(b);nv.utils.windowResize(b.update);return b})}}).error(function(a){})}a.statistics={md:{},search:{mainSearchStatistics:{},
terms:{},services:[]}};a.termsForSearchService="q";a.currentField="any";a.dateMin=null;a.dateMax=null;a.dateFrom=null;a.dateTo=null;a.graphicType="MONTH";a.searchStatisticExport=function(){c.get("stat.tableExport?tableToExport=requests").success(function(b){a.requestsExport=e.trustAsHtml(b)}).error(function(a){});c.get("stat.tableExport?tableToExport=params").success(function(b){a.paramsExport=e.trustAsHtml(b)}).error(function(a){})};a.$watch("graphicType",g);a.$watch("dateFrom",g);a.$watch("dateTo",
g);(function(){c.get("statistics-search@json?service=q").success(function(b){a.statistics.search.mainSearchStatistics.q=b}).error(function(a){});c.get("statistics-search@json?service=csw").success(function(b){a.statistics.search.mainSearchStatistics.csw=b}).error(function(a){});c.get("statistics-search-ip@json").success(function(b){a.statistics.search.ip=b}).error(function(a){})})();g();(function(){c.get("statistics-search-by-service-type@json").success(function(b){var c=0,e;for(e in b)b[e].nbsearch=
parseInt(b[e].nbsearch),c+=b[e].nbsearch;a.statistics.search.byServiceType=b;nv.addGraph(function(){var a=nv.models.pieChart().x(function(a){return d(a.service)}).y(function(a){return a.nbsearch}).values(function(a){return a}).tooltips(!0).tooltipContent(function(a,b,e,f){return"<h3>"+a+"</h3><p>"+parseInt(b).toFixed()+" "+d("searches")+" ("+(b/c*100).toFixed()+"%)</p>"}).showLabels(!0);d3.select("#gn-stat-search-by-service").datum([b]).transition().duration(1200).call(a);return a})}).error(function(a){})})();
(function(){c.get("statistics-search-fields@json").success(function(b){a.statistics.search.fields=b;for(var c in b){var d=b[c].service;-1===a.statistics.search.services.indexOf(d)&&a.statistics.search.services.push(d)}a.statistics.search.services.sort()}).error(function(a){});a.viewTermsForField=function(b,d){a.currentField=b;c.get("statistics-search-terms@json?field="+b+"&service="+d).success(function(b){a.statistics.search.terms.any=b}).error(function(a){})};a.viewTermsForField(a.currentField,a.termsForSearchService)})()}])})();(function(){angular.module("gn_dashboard_content_stat_controller",[]).controller("GnDashboardContentStatController",["$scope","$routeParams","$http","$translate",function(a,b,c,d){function e(b,e){c.get("statistics-content-metadata@json?by="+b+"&isTemplate="+encodeURIComponent(e||"n")).success(function(c){if("null"!=c){var e=0,f;for(f in c)c[f].total=parseInt(c[f].total),e+=c[f].total;a.statistics.md[b]=c;nv.addGraph(function(){var a=nv.models.pieChart().x(function(a){return d(a.label)}).y(function(a){return a.total}).values(function(a){return a}).tooltips(!0).tooltipContent(function(a,
b,c,f){return"<h3>"+a+"</h3><p>"+parseInt(b).toFixed()+" "+d("records")+" ("+(b/e*100).toFixed()+"%)</p>"}).showLabels(!0);d3.select("#gn-stat-md-by-"+b).datum([c]).transition().duration(1200).call(a);return a})}}).error(function(a){})}a.statistics={md:{}};a.hits=10;a.currentIndicator=null;a.currentIndicatorData=null;a.$watch("currentIndicator",function(){if(null!==a.currentIndicator){var b=[],c=0;$.each(a.currentIndicator,function(a,d){var e=parseInt(d["@count"]);b.push({label:d["@name"],count:e});
c+=e});nv.addGraph(function(){var a=nv.models.pieChart().x(function(a){return a.label}).y(function(a){return a.count}).values(function(a){return a}).tooltips(!0).tooltipContent(function(a,b,e,g){return"<h3>"+a+"</h3><p>"+parseInt(b).toFixed()+" "+d("records")+" ("+(b/c*100).toFixed()+"%)</p>"}).showLabels(!0);d3.select("#gn-stat-md-by-facet").datum([b]).transition().duration(1200).call(a);return a})}});(function(){c.get("statistics-content@json").success(function(b){a.statistics.md.mainStatistics=
b}).error(function(a){});c.get("qi@json?fast=index&sortBy=popularity&from=1&to="+a.hits).success(function(b){a.statistics.md.popularity=b.metadata}).error(function(a){});c.get("qi@json?fast=index&sortBy=rating&from=1&to="+a.hits).success(function(b){a.statistics.md.rating=b.metadata}).error(function(a){})})();e("schema");e("template","%");e("source");e("harvest");e("category");e("status");e("validity");e("owner");e("groupowner")}])})();(function(){angular.module("gn_dashboard_controller",["gn_dashboard_status_controller","gn_dashboard_search_stat_controller","gn_dashboard_content_stat_controller"]).controller("GnDashboardController",["$scope","$http",function(a,b){a.pageMenu={folder:"dashboard/",defaultTab:"status",tabs:[{type:"status",label:"status",icon:"fa-dashboard",href:"#/dashboard/status"},{type:"statistics-search",label:"searchStatistics",icon:"fa-search",href:"#/dashboard/statistics-search"},{type:"statistics-content",
label:"contentStatistics",icon:"fa-bar-chart",href:"#/dashboard/statistics-content"},{type:"information",label:"information",icon:"fa-list-ul",href:"#/dashboard/information"}]};a.info={};b.get(a.url+"xml.config.info@json").success(function(b){a.info=b}).error(function(a){})}])})();(function(){angular.module("gn_importxsl_directive",[]).directive("gnImportXsl",["$http","$translate",function(a,b){return{restrict:"A",replace:!0,transclude:!0,scope:{element:"=gnImportXsl"},templateUrl:"../../catalog/components/admin/importxsl/partials/importxsl.html",link:function(b,d,e){a.get("info@json?type=importStylesheets").success(function(a){b.stylesheets=a.stylesheets})}}}])})();(function(){angular.module("gn_importxsl",["gn_importxsl_directive"])})();(function(){var a=angular.module("gn_harvester_directive",[]);a.directive("gnHarvesterIdentification",["$http","$rootScope",function(a,c){return{restrict:"A",replace:!0,transclude:!0,scope:{harvester:"=gnHarvesterIdentification"},templateUrl:"../../catalog/components/admin/harvester/partials/identification.html",link:function(c,e,g){c.lang="eng";a.get("admin.harvester.info@json?type=icons").success(function(a){c.icons=a[0]});a.get("admin.group.list@json").success(function(a){c.groups="null"!==a?a:
null});c.setIcon=function(a){c.harvester.site.icon=a}}}}]);a.directive("gnHarvesterAccount",[function(){return{restrict:"A",replace:!0,transclude:!0,scope:{harvester:"=gnHarvesterAccount"},templateUrl:"../../catalog/components/admin/harvester/partials/account.html",link:function(a,c,d){}}}]);a.directive("gnHarvesterSchedule",["$translate",function(a){return{restrict:"A",replace:!0,transclude:!0,scope:{harvester:"=gnHarvesterSchedule"},templateUrl:"../../catalog/components/admin/harvester/partials/schedule.html",
link:function(a,b,e){}}}]);a.directive("gnHarvesterPrivileges",["$http","$translate","$rootScope",function(a,c,d){return{restrict:"A",replace:!0,transclude:!0,scope:{harvester:"=gnHarvesterPrivileges"},templateUrl:"../../catalog/components/admin/harvester/partials/privileges.html",link:function(a,b,c){var d=[{"@id":"1",operation:[{"@name":"view"},{"@name":"dynamic"}]}];a.visibleTo=function(b){"all"==b?a.harvester.privileges=d:"none"==b&&(a.harvester.privileges=[])};a.harvester.privileges&&1===a.harvester.privileges.length&&
"1"==a.harvester.privileges[0]["@id"]&&$("#gn-harvester-visible-all").button("toggle")}}}])})();(function(){angular.module("gn_harvester",["gn_harvester_directive"])})();(function(){angular.module("gn_category_directive",[]).directive("gnCategory",["$http","$translate",function(a,b){return{restrict:"A",replace:!0,transclude:!0,scope:{element:"=gnCategory",lang:"@lang",label:"@label"},templateUrl:"../../catalog/components/category/partials/category.html",link:function(b,d,e){a.get("info@json?type=categories").success(function(a){b.categories=a.metadatacategory}).error(function(a){})}}}])})();(function(){angular.module("gn_category",["gn_category_directive"])})();(function(){angular.module("gn_harvest_controller",["gn_harvester","gn_category"]).controller("GnHarvestController",["$scope","$http","$translate","$injector","$rootScope","gnSearchManagerService","gnUtilityService",function(a,b,c,d,e,g,f){function h(){return b.get("admin.harvester.list@json").success(function(b){"null"!=b&&(a.harvesters=b,f.parseBoolean(a.harvesters))}).error(function(a){})}function k(){a.harvesterHistory=void 0;b.get("admin.harvester.history@json?uuid="+a.harvesterSelected.site.uuid).success(function(b){a.harvesterHistory=
b.harvesthistory}).error(function(a){})}a.pageMenu={folder:"harvest/",defaultTab:"harvest",tabs:[]};a.harvesterTypes={};a.harvesters={};a.harvesterSelected=null;a.harvesterUpdated=!1;a.harvesterNew=!1;a.harvesterHistory={};a.harvesterRecordsPagination={pages:-1,currentPage:0,hitsPerPage:10};a.harvesterRecords=null;a.harvesterRecordsFilter=null;a.harvesterRecordsSearch=g.register({records:"harvesterRecords",filter:"harvesterRecordsFilter",pager:"harvesterRecordsPagination"},a);a.$watch("harvesterRecordsPagination.currentPage",
function(){a.harvesterRecordsSearch()});a.getTplForHarvester=function(){return a.harvesterSelected?"../../catalog/templates/admin/"+a.pageMenu.folder+"type/"+a.harvesterSelected["@type"]+".html":null};a.updatingHarvester=function(){a.harvesterUpdated=!0};a.addHarvester=function(b){a.harvesterNew=!0;a.harvesterHistory={};a.harvesterSelected=window["gnHarvester"+b].createNew()};a.cloneHarvester=function(c){b.get("admin.harvester.clone@json?id="+c).success(function(b){h().then(function(){angular.forEach(a.harvesters,
function(c){c["@id"]===b[0]&&a.selectHarvester(c)})})}).error(function(a){})};a.buildResponseGroup=function(a){var b="";angular.forEach(a.privileges,function(a){var c="";angular.forEach(a.operation,function(a){c+='<operation name="'+a["@name"]+'"/>'});b+='<group id="'+a["@id"]+'">'+c+"</group>"});return"<privileges>"+b+"</privileges>"};a.buildResponseCategory=function(a){var b="";angular.forEach(a.categories,function(a){b+='<category id="'+a["@id"]+'"/>'});return"<categories>"+b+"</categories>"};
a.saveHarvester=function(){var d=window["gnHarvester"+a.harvesterSelected["@type"]].buildResponse(a.harvesterSelected,a);b.post("admin.harvester."+(a.harvesterNew?"add":"update")+"@json",d,{headers:{"Content-type":"application/xml"}}).success(function(a){h();e.$broadcast("StatusUpdated",{msg:c("harvesterUpdated"),timeout:2,type:"success"})}).error(function(a){console.log(a)})};a.selectHarvester=function(b){"thredds"===b["@type"]&&(a.threddsCollectionsMode=""!==b.options.outputSchemaOnAtomicsDIF?"DIF":
"UNIDATA",a.threddsAtomicsMode=""!==b.options.outputSchemaOnCollectionsDIF?"DIF":"UNIDATA");a.harvesterSelected=b;a.harvesterUpdated=!1;a.harvesterNew=!1;a.harvesterHistory={};a.harvesterRecords=null;k();a.harvesterRecordsFilter={template:"y or s or n",siteId:a.harvesterSelected.site.uuid,sortBy:"title"};a.harvesterRecordsSearch()};a.refreshHarvester=function(){h()};a.deleteHarvester=function(){b.get("admin.harvester.remove@json?id="+a.harvesterSelected["@id"]).success(function(b){a.harvesterSelected=
{};a.harvesterUpdated=!1;a.harvesterNew=!1;h()}).error(function(a){console.log(a)})};a.deleteHarvesterRecord=function(){b.get("admin.harvester.clear@json?id="+a.harvesterSelected["@id"]).success(function(b){a.harvesterSelected={};a.harvesterUpdated=!1;a.harvesterNew=!1;h()}).error(function(a){console.log(a)})};a.deleteHarvesterHistory=function(){var c=[];angular.forEach(a.harvesterHistory,function(a){c.push(a.id)});b.get("admin.harvester.history.delete@json?id="+c.join("&id=")).success(function(b){h().then(function(){a.selectHarvester(a.harvesterSelected)})})};
a.runHarvester=function(){b.get("admin.harvester.run@json?id="+a.harvesterSelected["@id"]).success(function(a){h()})};a.setHarvesterSchedule=function(){if(a.harvesterSelected){var d=a.harvesterSelected.options.status;b.get("admin.harvester."+("active"===d?"start":"stop")+"@json?id="+a.harvesterSelected["@id"]).success(function(a){}).error(function(a){e.$broadcast("StatusUpdated",{title:c("harvesterSchedule"+d),error:a,timeout:0,type:"danger"})})}};a.$watch("harvesterSelected.options.status",function(){a.setHarvesterSchedule()});
h();(function(){b.get("admin.harvester.info@json?type=harvesterTypes").success(function(b){angular.forEach(b[0],function(b){a.harvesterTypes[b]={label:b,text:c(b)};$.getScript("../../catalog/templates/admin/harvest/type/"+b+".js").done(function(c,d){a.harvesterTypes[b].loaded=!0}).fail(function(c,d,e){a.harvesterTypes[b].loaded=!1})})}).error(function(a){})})();a.geonetworkGetSources=function(c){b.get(a.proxyUrl+encodeURIComponent(c+"/srv/eng/info?type=sources")).success(function(b){a.geonetworkSources=
[];var c=0;b=$.parseXML(b);b=$(b);$sources=b.find("uuid");$names=b.find("name");angular.forEach($sources,function(b){a.geonetworkSources.push({uuid:b.textContent,name:$names[c].textContent});c++})}).error(function(a){})};a.oaipmhSets=null;a.oaipmhPrefix=null;a.oaipmhInfo=null;a.oaipmhGet=function(){a.oaipmhInfo=null;b.post("admin.harvester.info@json",'<request><type url="'+a.harvesterSelected.site.url+'">oaiPmhServer</type></request>',{headers:{"Content-type":"application/xml"}}).success(function(b){b[0].sets&&
b[0].formats?(a.oaipmhSets=b[0].sets,a.oaipmhPrefix=b[0].formats):a.oaipmhInfo=c("oaipmh-FailedToGetSetsAndPrefix")}).error(function(a){})};a.$watch("harvesterSelected.site.url",function(){a.harvesterSelected&&"oaipmh"===a.harvesterSelected["@type"]&&a.oaipmhGet()});a.cswCriteria=[];a.cswCriteriaInfo=null;a.cswGetCapabilities=function(){a.cswCriteriaInfo=null;if(a.harvesterSelected&&a.harvesterSelected.site&&a.harvesterSelected.site.capabilitiesUrl){var d=a.harvesterSelected.site.capabilitiesUrl;
-1===d.indexOf("GetCapabilities")&&(d+=(-1===d.indexOf("?")?"?":"&")+"SERVICE=CSW&REQUEST=GetCapabilities&VERSION=2.0.2");b.get(a.proxyUrl+encodeURIComponent(d)).success(function(b){a.cswCriteria=[];try{var d=$.parseXML(b);a.harvesterSelected.searches||(a.harvesterSelected.searches=[{}]);var e=["SupportedISOQueryables","SupportedQueryables","AdditionalQueryables"];$(d).find("Constraint").each(function(){-1!==e.indexOf($(this).attr("name"))&&$(this).find("Value").each(function(){var b=$(this).text();
a.cswCriteria.push(b);a.harvesterSelected.searches[0][b]||(a.harvesterSelected.searches[0][b]={value:""})})});a.cswCriteria.sort()}catch(f){a.cswCriteriaInfo=c("csw-FailedToParseCapabilities")}}).error(function(a){})}};a.$watch("harvesterSelected.site.capabilitiesUrl",function(){a.cswGetCapabilities()});a.harvesterTemplates=null;var l=function(){b.get("info@json?type=templates").success(function(b){a.harvesterTemplates=b.templates})};a.harvesterGetFeatureXSLT=null;var n=function(){a.oaipmhInfo=null;
b.post("admin.harvester.info@json","<request><type>wfsFragmentStylesheets</type><schema>"+a.harvesterSelected.options.outputSchema+"</schema></request>",{headers:{"Content-type":"application/xml"}}).success(function(b){a.harvesterGetFeatureXSLT=b[0]})};a.$watch("harvesterSelected.options.outputSchema",function(){a.harvesterSelected&&"wfsfeatures"===a.harvesterSelected["@type"]&&(n(),l())});a.threddsCollectionsMode="DIF";a.threddsAtomicsMode="DIF";a.harvesterThreddsXSLT=null;var m=function(){a.oaipmhInfo=
null;var c=a.harvesterSelected.options;b.post("admin.harvester.info@json","<request><type>threddsFragmentStylesheets</type><schema>"+("DIF"===a.threddsCollectionsMode?c.outputSchemaOnCollectionsDIF:c.outputSchemaOnCollectionsFragments)+"</schema></request>",{headers:{"Content-type":"application/xml"}}).success(function(b){a.harvesterThreddsXSLT=b[0]})};a.$watch("harvesterSelected.options.outputSchemaOnCollectionsDIF",function(){a.harvesterSelected&&"thredds"===a.harvesterSelected["@type"]&&(m(),l())});
a.$watch("harvesterSelected.options.outputSchemaOnCollectionsFragments",function(){a.harvesterSelected&&"thredds"===a.harvesterSelected["@type"]&&(m(),l())})}])})();(function(){angular.module("gn_system_settings_controller",[]).controller("GnSystemSettingsController",["$scope","$http","$rootScope","$translate","gnUtilityService",function(a,b,c,d,e){a.settings=[];var g=[],f=[];a.sectionsLevel1=[];a.sectionsLevel2=[];a.systemUsers=null;a.filterBySection=function(b){for(var c=[],d=0;d<a.settings.length;d++){var e=a.settings[d];-1!==e["@name"].indexOf(b)&&c.push(e)}return c};a.getOrderBy=function(a){return a["@position"]};a.saveSettings=function(f){b.get(a.url+"admin.config.save?"+
e.serialize(f)).success(function(b){c.$broadcast("StatusUpdated",{msg:d("settingsUpdated"),timeout:2,type:"success"});a.loadCatalogInfo()}).error(function(a){c.$broadcast("StatusUpdated",{title:d("settingsUpdateError"),error:a,timeout:0,type:"danger"})})};a.scrollTo=e.scrollTo;(function(){b.get("admin.user.list@json").success(function(b){a.systemUsers=b})})();(function(){b.get("xml.config.get@json?asTree=false").success(function(b){e.parseBoolean(b);a.settings=b;for(b=0;b<a.settings.length;b++){var c=
a.settings[b]["@name"].split("/");a.settings[b].formName=a.settings[b]["@name"].replace(/\//g,".");c&&(-1===g.indexOf(c[0])&&(g.push(c[0]),a.sectionsLevel1.push({name:c[0],"@position":a.settings[b]["@position"]})),c=c[0]+"/"+c[1],-1===f.indexOf(c)&&(f.push(c),a.sectionsLevel2.push({name:c,"@position":a.settings[b]["@position"]})))}}).error(function(a){})})()}])})();(function(){angular.module("gn_csw_settings_controller",[]).controller("GnCSWSettingsController",["$scope","$http","$rootScope","$translate","gnUtilityService",function(a,b,c,d,e){function g(){b.get("xml.config.get@json?asTree=false").success(function(b){for(var c=0;c<b.length;c++){var d=b[c];if(-1!==k.indexOf(d["@name"])){var e=d["#text"].toLowerCase();a.cswSettings[d["@name"]]="true"==e||"on"==e}else-1!==h.indexOf(d["@name"])&&(a.cswSettings[d["@name"]]=d["#text"])}}).error(function(a){})}function f(){b.get("admin.config.csw.customelementset@json").success(function(b){a.cswElementSetName=
b?$.isArray(b.xpath)?b.xpath:[b.xpath]:[]})}var h=["system/csw/contactId"],k=["system/csw/enable","system/csw/metadataPublic"];a.cswSettings={};a.cswElementSetName=[];a.cswFieldFilterValue="";a.cswLanguageFilterValue=a.lang;a.cswLanguages={};a.cswFields={};a.addCSWElementSetName=function(){a.cswElementSetName.push([""])};a.deleteElementSetName=function(b){b=$.inArray(b,a.cswElementSetName);a.cswElementSetName.splice(b,1)};a.saveCSWElementSetName=function(a){b.get("admin.config.csw.customelementset.save@json?"+
$(a).serialize()).success(function(a){f()})};a.saveSettings=function(a){l(a,"admin.config.save")};a.saveProperties=function(a){l(a,"admin.config.csw.save")};var l=function(a,f){b.get(f+"?"+e.serialize(a)).success(function(a){c.$broadcast("StatusUpdated",{msg:d("settingsUpdated"),timeout:2,type:"success"})}).error(function(a){c.$broadcast("StatusUpdated",{title:d("settingsUpdateError"),error:a,timeout:0,type:"danger"})})};a.cswFilter=function(b){var c=[],d=a.cswFieldFilterValue,e=a.cswLanguageFilterValue;
b&&angular.forEach(b,function(a,f){var g=!1;""!==e&&""===d&&b[f].langid===e&&(g=!0);""!==d&&""===e&&b[f].fieldname===d&&(g=!0);""!==d&&""!==e&&b[f].langid===e&&b[f].fieldname===d&&(g=!0);""===d&&""===e&&(g=!0);g&&c.push(b[f])});return c};(function(){b.get("admin.user.list@json").success(function(b){a.users=b;g()}).error(function(a){})})();(function(){b.get("admin.config.csw@json").success(function(b){a.cswConfig=b.record;angular.forEach(a.cswConfig,function(b,c){a.cswLanguages[a.cswConfig[c].langid]=
!0;a.cswFields[a.cswConfig[c].fieldname]=!0});g()}).error(function(a){})})();f()}])})();(function(){angular.module("gn_scroll_spy_directive",[]).directive("gnScrollSpy",["gnUtilityService","$timeout",function(a,b){return{restrict:"A",replace:!1,transclude:!0,scope:{id:"@gnScrollSpy",watch:"=",depth:"@",allDepth:"@",collapse:"@"},templateUrl:"../../catalog/components/scrollspy/partials/scrollspy.html",link:function(c,d,e){var g=0,f=c.depth||2,h=0,k=a.isInView,l="true"==c.allDepth?"fieldset > legend":"fieldset > fieldset > legend";c.scrollTo=a.scrollTo;c.spyElems=null;var n=function(){var a=
$(this).attr("id"),b=$(this).parents("fieldset").length-1-h;if(b<=f){a||(a=c.id+"-"+b+"-"+g++,$(this).attr("id",a));a={id:"#"+a,label:$(this).text(),elem:$(this).parent(),active:!1,children:[]};if(0===b)c.spyElems.push(a);else{var d=("true"==c.allDepth?$(this):$(this).parent("fieldset")).parent("fieldset").parent("fieldset").children("legend").attr("id");d&&(b=$.grep(c.spyElems,function(a){return a.id==="#"+d}),b[0]&&b[0].children.push(a))}$(this).parent().find(l).each(n)}},m=function(){c.spyElems=
[];rootElement=$("#"+c.id);h=rootElement.parents("fieldset").length;void 0===rootElement.prop("tagName")?console.log(c.id+" element is not available for scroll spy."):("fieldset"===rootElement.prop("tagName").toLowerCase()&&h++,rootElement.find("> fieldset > legend").each(n),$(window).scroll(function(){c.$apply(function(){angular.forEach(c.spyElems,function(a){a.active=k(a.elem)?!0:!1;a.children&&angular.forEach(a.children,function(a){a.active=k(a.elem)?!0:!1})})})}))};c.watch?c.$watch("watch",function(a){b(function(){null===
c.spyElems&&m()},200)},!0):m()}}}])})();(function(){angular.module("gn_scroll_spy",["gn_scroll_spy_directive"])})();(function(){angular.module("gn_csw_virtual_controller",[]).controller("GnCSWVirtualController",["$scope","$http","$rootScope","$translate",function(a,b,c,d){function e(){a.virtualCSWSelected={};b.get("admin.config.virtualcsw.list@json").success(function(b){a.cswVirtual="null"!=b?b:[]}).error(function(a){})}a.cswVirtual={};a.virtualCSWSelected=null;a.virtualCSWUpdated=!1;a.virtualCSWSearch="";a.groupsFilter={};a.sourcesFilter={};a.categoriesFilter={};var g="";a.updatingVirtualCSW=function(){a.virtualCSWUpdated=
!0};a.selectVirtualCSW=function(c){g="updateservice";b.get("admin.config.virtualcsw.get@json?id="+c.id).success(function(b){a.virtualCSWSelected=b;a.virtualCSWUpdated=!1}).error(function(a){})};a.addVirtualCSW=function(){g="newservice";a.virtualCSWSelected={id:"",name:"csw-servicename",description:"",serviceParameters:{any:"","abstract":"",title:"",_source:"",_groupPublished:"",keyword:"",_cat:"",denominator:"",type:""}}};a.saveVirtualCSW=function(a){b.get("admin.config.virtualcsw.update@json?operation="+
g+"&"+$(a).serialize()).success(function(a){e();c.$broadcast("StatusUpdated",{msg:d("virtualCswUpdated"),timeout:2,type:"success"})}).error(function(a){c.$broadcast("StatusUpdated",{title:d("virtualCswUpdateError"),error:a,timeout:0,type:"danger"})})};a.deleteVirtualCSW=function(){b.get("admin.config.virtualcsw.remove?id="+a.virtualCSWSelected.id).success(function(a){e()}).error(function(a){c.$broadcast("StatusUpdated",{title:d("virtualCswDeleteError"),error:a,timeout:0,type:"danger"})})};a.getCapabilitiesUrl=
function(a){return a?a.name+"?SERVICE=CSW&REQUEST=GetCapabilities":null};e();(function(){b.get("admin.group.list@json").success(function(b){a.groupsFilter=b}).error(function(a){})})()}])})();(function(){angular.module("gn_csw_test_controller",[]).controller("GnCSWTestController",["$scope","$http",function(a,b){a.cswTests={};a.currentTestId=null;a.currentTest=null;a.currentTestResponse=null;a.$watch("currentTestId",function(){null!=a.currentTestId&&b.get("../../xml/csw/test/"+a.currentTestId+".xml").success(function(b){a.currentTest=b;a.runCSWRequest()})});a.runCSWRequest=function(){a.currentTestResponse="";b.post("csw",a.currentTest,{headers:{"Content-type":"application/xml"}}).success(function(b){a.currentTestResponse=
b})};(function(){b.get("../../xml/csw/test/csw-tests.json").success(function(b){a.cswTests=b})})()}])})();(function(){angular.module("gn_logo_settings_controller",["blueimp.fileupload"]).controller("GnLogoSettingsController",["$scope","$http","$rootScope","$translate",function(a,b,c,d){a.logos=[];loadLogo=function(){a.logos=[];b.get("admin.logo.list@json?type=icons").success(function(b){a.logos=b[0]}).error(function(a){})};loadLogoError=function(a,b){c.$broadcast("StatusUpdated",{title:d("logoUploadError"),error:b.jqXHR.responseJSON,timeout:0,type:"danger"})};a.logoUploadOptions={autoUpload:!0,done:loadLogo,
fail:loadLogoError};a.setCatalogLogo=function(a,g){b.get("admin.logo.update?fname="+a+"&favicon="+g).success(function(a){c.$broadcast("StatusUpdated",{msg:d("logoUpdated"),timeout:2,type:"success"});c.$broadcast("loadCatalogInfo")}).error(function(a){c.$broadcast("StatusUpdated",{title:d("logoUpdateError"),error:a,timeout:0,type:"danger"});loadLogo()})};a.removeLogo=function(a){b.get("admin.logo.remove?fname="+a).success(function(a){c.$broadcast("StatusUpdated",{msg:d("logoRemoved"),timeout:2,type:"success"});
loadLogo()}).error(function(a){c.$broadcast("StatusUpdated",{title:d("logoRemoveError"),error:a,timeout:0,type:"danger"});loadLogo()})};loadLogo()}])})();(function(){angular.module("gn_settings_controller","gn_system_settings_controller gn_csw_settings_controller gn_csw_virtual_controller gn_csw_test_controller gn_logo_settings_controller gn_scroll_spy".split(" ")).controller("GnSettingsController",["$scope",function(a){a.pageMenu={folder:"settings/",defaultTab:"system",tabs:[{type:"system",label:"settings",icon:"fa-cogs",href:"#/settings/system"},{type:"logo",label:"manageLogo",icon:"fa-picture-o",href:"#/settings/logo"},{type:"csw",label:"manageCSW",
href:"#/settings/csw"},{type:"csw-virtual",label:"manageVirtualCSW",href:"#/settings/csw-virtual"},{type:"csw-test",label:"testCSW",href:"#/settings/csw-test"}]}}])})();(function(){var a=angular.module("gn_admin_controller","gn_dashboard_controller gn_usergroup_controller gn_admintools_controller gn_settings_controller gn_adminmetadata_controller gn_classification_controller gn_harvest_controller gn_standards_controller".split(" "));a.config(["$routeProvider",function(a){a.when("/metadata",{templateUrl:"../../catalog/templates/admin/page-layout.html",controller:"GnAdminMetadataController"}).when("/metadata/:tab",{templateUrl:"../../catalog/templates/admin/page-layout.html",
controller:"GnAdminMetadataController"}).when("/metadata/:tab/:metadataAction/:schema",{templateUrl:"../../catalog/templates/admin/page-layout.html",controller:"GnAdminMetadataController"}).when("/dashboard",{templateUrl:"../../catalog/templates/admin/page-layout.html",controller:"GnDashboardController"}).when("/dashboard/:tab",{templateUrl:"../../catalog/templates/admin/page-layout.html",controller:"GnDashboardController"}).when("/organization",{templateUrl:"../../catalog/templates/admin/page-layout.html",
controller:"GnUserGroupController"}).when("/organization/:tab",{templateUrl:"../../catalog/templates/admin/page-layout.html",controller:"GnUserGroupController"}).when("/organization/:tab/:userOrGroup",{templateUrl:"../../catalog/templates/admin/page-layout.html",controller:"GnUserGroupController"}).when("/classification",{templateUrl:"../../catalog/templates/admin/page-layout.html",controller:"GnClassificationController"}).when("/classification/:tab",{templateUrl:"../../catalog/templates/admin/page-layout.html",
controller:"GnClassificationController"}).when("/tools",{templateUrl:"../../catalog/templates/admin/page-layout.html",controller:"GnAdminToolsController"}).when("/tools/:tab",{templateUrl:"../../catalog/templates/admin/page-layout.html",controller:"GnAdminToolsController"}).when("/harvest",{templateUrl:"../../catalog/templates/admin/page-layout.html",controller:"GnHarvestController"}).when("/settings",{templateUrl:"../../catalog/templates/admin/page-layout.html",controller:"GnSettingsController"}).when("/settings/:tab",
{templateUrl:"../../catalog/templates/admin/page-layout.html",controller:"GnSettingsController"}).when("/standards",{templateUrl:"../../catalog/templates/admin/page-layout.html",controller:"GnStandardsController"}).otherwise({templateUrl:"../../catalog/templates/admin/admin.html"})}]);a.controller("GnAdminController",["$scope","$http","$q","$rootScope","$route","$routeParams","gnUtilityService",function(a,c,d,e,g,f,h){a.menu={UserAdmin:[{name:"harvesters",route:"#harvest",classes:"btn-primary",icon:"fa-cloud-download"},
{name:"statisticsAndStatus",route:"#dashboard",classes:"btn-success",icon:"fa-dashboard"},{name:"usersAndGroups",route:"#organization",classes:"btn-default",icon:"fa-group"}],Administrator:[{name:"metadatasAndTemplates",route:"#metadata",classes:"btn-primary",icon:"fa-archive"},{name:"io",url:"home?insert",classes:"btn-primary",icon:"fa-upload"},{name:"harvesters",route:"#harvest",classes:"btn-primary",icon:"fa-cloud-download"},{name:"statisticsAndStatus",route:"#dashboard",classes:"btn-success",
icon:"fa-dashboard"},{name:"classificationSystems",route:"#classification",classes:"btn-info",icon:"fa-tags"},{name:"standards",route:"#standards",classes:"btn-info",icon:"fa-puzzle-piece"},{name:"usersAndGroups",route:"#organization",classes:"btn-default",icon:"fa-group"},{name:"settings",route:"#settings",classes:"btn-warning",icon:"fa-gear"},{name:"tools",route:"#tools",classes:"btn-warning",icon:"fa-medkit"}]};a.navStacked=!0;a.getTpl=function(c){a.type=c.defaultTab;$.each(c.tabs,function(c,d){d.type===
f.tab&&(a.type=f.tab)});return"../../catalog/templates/admin/"+c.folder+a.type+".html"};a.csvExport=function(a,b){$(b.target).next("pre.gn-csv-export").remove();$(b.target).after("<pre class='gn-csv-export'>"+h.toCsv(a)+"</pre>")};a.getMenuUrl=function(c){if(c.route)return c.route;if(c.url)return a.url+c.url};a.getMenu=function(){return a.menu[a.user.profile]}}])})();(function(){var a=angular.module("gn_admin",["gn","gn_admin_controller"]);a.constant("$LOCALES",["core","admin"]);a.config(["$translateProvider","$LOCALES",function(a,c){a.useLoader("localeLoader",{locales:c,prefix:"../../catalog/locales/",suffix:".json"});var d=location.href.split("/")[5].substring(0,2)||"en";a.preferredLanguage(d);moment.lang(d)}])})();
